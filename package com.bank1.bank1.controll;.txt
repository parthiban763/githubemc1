package com.bank1.bank1.controll;

import java.math.BigDecimal;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import com.bank1.bank1.model.UserEntity;
import com.bank1.bank1.service.BankService;

@RestController
@RequestMapping("/account")
public class controller {

    @Autowired
    private BankService bankService;

    @GetMapping
    public List<UserEntity> getuser() {
        return bankService.getAllAccounts1();
    }
    
 //   @PostMapping("/create")
//  public UserEntity createAccount(@RequestBody UserEntity user) {
//  	// System.out.println("Saving user: " + user.getOwnerName());
//      return BankServiceRepository.save(user);
//  }

    @PostMapping("/create")
    public UserEntity createAccount(@RequestBody UserEntity user) {
        return bankService.save(user);
        }

    @PostMapping("/{id}/deposit")
    public UserEntity deposit(@PathVariable Long id, @RequestParam BigDecimal amount) {
        return bankService.deposit1(id, amount);
    }

    @PostMapping("/{id}/withdraw")
    public UserEntity withdraw(@PathVariable Long id, @RequestParam BigDecimal amount) {
        return bankService.withdraw1(id, amount);
    }
}






package com.bank1.bank1.model;

import java.math.BigDecimal;

import com.fasterxml.jackson.annotation.JsonProperty;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.Table;

@Entity
@Table (name="parthiban")
public class UserEntity {
	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private Long id;

		@Column(name = "owner_name")
//	 @JsonProperty("owner_name")
	private String owner_Name;
	private int age;
	private BigDecimal balance;
	
	public Long getId() {
		return id;
	}

	public void setId(Long id) {
		this.id = id;
	}

	public String getOwnerName() {
		return owner_Name;
	}

	public void setOwnerName(String ownerName) {
		this.owner_Name = ownerName;
	}


	public int getAge() {
		return age;
	}

	public void setAge(int age) {
		this.age = age;
	}

	public BigDecimal getBalance() {
		return balance;
	}

	public void setBalance(BigDecimal balance) {
		this.balance = balance;
	}
     
}









package com.bank1.bank1.repository;
 
import java.math.BigDecimal;

//import com.example.bank1.model.BankAccount;

import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import com.bank1.bank1.model.UserEntity;
@Repository
public interface BankServiceRepository extends JpaRepository<UserEntity, Long> {

}








package com.bank1.bank1.service;

import java.math.BigDecimal;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.bank1.bank1.model.UserEntity;
import com.bank1.bank1.repository.BankServiceRepository;

@Service
	public class BankService {
	    @Autowired
	     private BankServiceRepository BankServiceRepository;
	    
	    public List<UserEntity> getAllAccounts1(){
			return BankServiceRepository.findAll();
	    }
	    
	    public UserEntity createAccount1(String owner_Name,BigDecimal initialBalance){
	    UserEntity account=new UserEntity();
	    account.setOwnerName(owner_Name);
	    account.setBalance(initialBalance);
	    return BankServiceRepository.save(account);
	}

       public UserEntity deposit1(Long accountId, BigDecimal amount) {
    	   UserEntity account= BankServiceRepository.findById(accountId)
    			   .orElseThrow(() -> new RuntimeException("Account not found"));
           account.setBalance(account.getBalance().add(amount));
           return BankServiceRepository.save(account);
       }

     

	   public UserEntity withdraw1(Long accountId, BigDecimal amount) {
           UserEntity account = BankServiceRepository.findById(accountId)
               .orElseThrow(() -> new RuntimeException("Account not found"));
           if (account.getBalance().compareTo(amount) < 0) {
               throw new RuntimeException("Insufficient balance");
           }
           account.setBalance(account.getBalance().subtract(amount));
           return BankServiceRepository.save(account);
       }

	   public UserEntity save(UserEntity user) {
		return user;
		
	   }

	  
   
		}




